<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/layout}">
<head>
<meta charset="UTF-8">
<title>발주현황</title>
</head>
<body>
	<div layout:fragment="content" class="page-content">
		<div id="content">
			<h3>발주현황</h3>
			&nbsp;
			<table class="mb-5">
				<tr id="c1">
					<td id="detail">부서 <input type="text" id="code_group"
						name="cg"> <i class="bi bi-search"> </i> 사원 <input
						type="text" id="code_group" name="code_group"> <i
						class="bi bi-search"> </i></td>
				</tr>
				<tr id="c2">
					<td>거래처 <input type="text" id="client_code" name="cc">
						<i class="bi bi-search"></i> 발주기간 <input type="date"> ~ <input
						type="date">
						<button type="button" id="SelectBtn">조회</button>
					</td>
				</tr>
			</table>
		</div>
		<br>
		<div id="grid"></div>
		<div id="grid2"></div>
		<script>
	$(document).ready(function() {
		$('#SelectBtn').click(selectList);
	});
	
	function selectList() {
		$.ajax({
			url : '/materialListInfo',
			success : function(data) {
				grid.resetData(data)
				console.log(data);
			},
			error : function(reject) {
				console.log(reject);
			}
		})
	}
	
   var gridData = [
       {
          name:'',
          artist:'',
          type:'',
          release:'',
          genre:''
       }];
   var grid = new tui.Grid({
	    el: document.getElementById('grid'),
	    data: gridData,
	    scrollX: false,
	    scrollY: false,
	    rowHeaders : ['checkbox'],
	    columns: [
	      {
	        header: '발주번호',
	        name: 'orderNo'
	      },
	      {
	        header: '발주일자',
	        name: 'orderDate'
	      },
	      {
	        header: '거래처코드',
	        name: 'clientCode'
	      },
	      {
	        header: '거래처명',
	        name: 'clientName'
	      },
	      {
	        header: '납기일',
	        name: 'orderReceiving'
	      },
	        {
	        header: '담당자',
	        name: 'manager'
	          }
	    ]
	  });
   
   
   grid.on('click',(ab)=>{
	   console.log(ab.nativeEvent.target.innerText)
	   $.ajax({
		   url:'/detailList',
		   data : {'orderNo' : ab.nativeEvent.target.innerText },
		   success : function(data) {
			   console.log(data);
			   grid2.resetData(data);				   
			   
		   },
		   error :  function(reject) {
			   console.log(111)
		   }
	   })
	   
   })
   
   //상세조회
  var grid2 = new tui.Grid({
    el: document.getElementById('grid2'),
    rowHeders : ['rowNum'], 
    data: gridData,
    scrollX: false,
    scrollY: false,
    
    columns: [
      {
        header: '품번',
        name: 'proCode'
      },
      {
        header: '품명',
        name: 'proName'
      },
      {
        header: '규격',
        name: 'standard'
      },
      {
        header: '단위',
        name: 'unit'
      },
      {
        header: '발주수량',
        name: 'orderNum'
        },
        {
        header: '검사수량',
        name: 'checkNum'
          },
          {
        header: '구분',
        name: 'orderGroup'
            }
    ]
  });	  
   </script>
	</div>
</body>
</html>